<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-type' content='text/html; charset=utf-8'>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=1.0, user-scalable=yes">
	<meta name="Description" content="素材来源网络，仅供学术交流">
    <title>前世的她</title>
    <script src="../js/react.min.js"></script>
    <script src="../js/JSXTransformer.js"></script>
    <script src="http://libs.baidu.com/jquery/1.11.1/jquery.min.js"></script>
	<!--<script src="../js/data.js"></script>-->
	<style>
		* {
			margin:0;
			padding:0;
		}
		a {
			text-decoration:none;
		}
		body{
			background-color:#fff;
			color:#555;
			font-family:'Avenir Next', 'Lantinghei SC';
			font-size:14px;
			-wevbkit-font-smoothing:antialiased;	
		}
		.wrap{
			width:100%;
			/*设置垂直居中start*/
			height:600px;
			position:absolute;
			top:50%;
			margin-top:-300px;
			/*设置垂直居中end*/
			background-color:#333;
			overflow:hidden;

			-webkit-perspective:800px;
			-moz-perspective:800px;
			perspective:800px;
		}
		.photo{
			width:260px;
			height:320px;
			position:absolute;
			z-index:1;
			box-shadow:0 0 1px rgba(0,0,0,.01);
			-webkit-transition:all .6s;
			transition:all .6s;
			-ms-transition:all .6s;
			-moz-transition:all .6s;
			-o-transition:all .6s;
			left:50%;
			top:50%;
			margin;-160px 0 0 -130px;
		}
		.photo .side{
			width:100%;
			height:100%;
			background-color:#eee;
			top:0;
			right:0;
			position:absolute;
			padding:20px;
			box-sizing:border-box;

		}
		.photo .side-front{}
		.photo .side-back .imageB{
			padding-bottom:8px;
			width:100%;
			height:160px;
			line-height:200px;
			overflow:hidden;
			text-align:center;
		}
		.photo .side-back .imageB img{
			height:160px;
		}
		.photo .side-front .image{
			width:100%;
			height:250px;
			line-height:250px;
			overflow:hidden;
		}
		.photo .side-front .image img{
			width:100%;
		}
		.photo .side-front .caption{
			padding-top:10px;
			font-size:0.8em;
			text-indent: 1em;
			line-height:20px;
		}
		.photo .side-back{}
		.photo .side-back .desc{
			color:#666;
			font-size:0.8em;
			line-height:1.5em;
			text-indent: 1em;
		}
		/*选中：水平、垂直居中方法。设为宽高一半*/
		.photo_center {
			width:260px;
			height:320px;
			left:50%;
			top:50%;
			margin:-160px 0 0 -130px;
			z-index:999;
		}
		.photo_wrap{
			width:100%;
			height:118%;
			position:absolute;
			transform-style: preserve-3d;
			-webkit-transform-style: preserve-3d;	/* Safari 和 Chrome */
			-moz-transform-style: preserve-3d;

			-webkit-transition:-webkit-transform .6s ease-in-out;
			transition:transform .6s ease-in-out;
			-ms-transition:-ms-transform .6s ease-in-out;
			-moz-transition:-moz-transform .6s ease-in-out;
			-o-transition:-o-transform .6s ease-in-out;
			
			-webkit-transform-origin:0% 50%;
			transform-origin:0% 50%;
			-ms-transform-origin:0% 50%;
			-moz-transform-origin:0% 50%;
			-o-transform-origin:0% 50%;

		}
		.photo_wrap .side-front{
			transform:rotateY(360deg);
			-ms-transform:rotateY(360deg); 	/* IE 9 */
			-moz-transform:rotateY(360deg); 	/* Firefox */
			-webkit-transform:rotateY(360deg); /* Safari 和 Chrome */
			-o-transform:rotateY(360deg); 	/* Opera */

		}
		.photo_wrap .side-back{
			transform:rotateY(180deg);
			-ms-transform:rotateY(180deg); 	/* IE 9 */
			-moz-transform:rotateY(180deg); 	/* Firefox */
			-webkit-transform:rotateY(180deg); /* Safari 和 Chrome */
			-o-transform:rotateY(180deg); 	/* Opera */
		}
		.photo_wrap .side{
			backface-visibility:hidden;
			-webkit-backface-visibility:hidden;	/* Chrome 和 Safari */
			-moz-backface-visibility:hidden; 	/* Firefox */
			-ms-backface-visibility:hidden; 	/* Internet Explorer */
		}
		.photo_front .photo_wrap{
			transform:translate(0pc,0px) rotateY(0deg);
			-ms-transform:translate(0px,0px) rotateY(0deg); 	/* IE 9 */
			-moz-transform:translate(0px,0px) rotateY(0deg); 	/* Firefox */
			-webkit-transform:translate(0px,0px) rotateY(0deg); /* Safari 和 Chrome */
			-o-transform:translate(0px,0px) rotateY(0deg); 	/* Opera */
		}
		.photo_back .photo_wrap{
			transform:translate(260px,0px) rotateY(180deg);
			-ms-transform:translate(260px,0px) rotateY(180deg); 	/* IE 9 */
			-moz-transform:translate(260px,0px) rotateY(180deg); 	/* Firefox */
			-webkit-transform:translate(260px,0px) rotateY(180deg); /* Safari 和 Chrome */
			-o-transform:translate(260px,0px) rotateY(180deg); 	/* Opera */
		}
		@font-face{
			font-family:'Glyphicons Halflings';
			font-family:'Glyphicons Halflings';
			src:url('fonts/glyphicons-halflings-regular.eot');   /* IE9 Compat Modes */
			src:url('fonts/glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'),/* IE6-IE8 */
			url('fonts/glyphicons-halflings-regular.woff') format('woff'),  /* Modern Browsers */
			url('fonts/glyphicons-halflings-regular.ttf') format('truetype'),/* Safari, Android, iOS */
			url('fonts/glyphicons-halflings-regular.svg#glyphicons-halflingsregular') format('svg'); /* Legacy iOS */
			font-weight:normal;
			font-size:normal;
		}
	</style>
  </head>
  <body onselectstart="return false;">
    <div id="container">
    </div>
    <script >
		var gg = '金陵十二钗在配方中首次采用了海洋生物活性提取物作为特有添加物，丰富了卷烟香气。具有别样的香气特征，香气优雅飘逸，烟气细腻柔和，吃味生津回甜，余味干净舒适。\n    在包装设计上突出古雅的艺术风格。商标集“金陵十二钗”人物图、著名七绝诗句、篆书标题为一体，画、诗、书、印古朴典雅、搭配错落有致、相得益彰，使产品的现代美与古典美、内在质量与外在艺术和谐统一。';
		var data = [
		  {img:'../image/01.png',imgB:'../image/b01.png',caption:'林黛玉',descF:'你的前世情人是她——林黛玉 。她天真率直,生得倾城倾国容貌，兼有旷世诗才，是世界文学作品中最富灵气的经典女性形象。',desc:'',key:1},
		  {img:'../image/02.png',imgB:'../image/b02.png',caption:'薛宝钗 ',descF:'你的前世情人是她——薛宝钗 。她艳冠群芳、温柔体贴、愤世嫉俗、宽厚待人，贤妻良母之典范还数宝钗。',desc:'',key:2},
		  {img:'../image/03.png',imgB:'../image/b03.png',caption:'贾元春',descF:'你的前世情人是她——贾元春 。贾政与王夫人之长女。自幼由贾母教养。因贤孝才德，选入宫作女吏。不久，封凤藻宫尚书，加封贤德妃。',desc:'',key:3},
		  {img:'../image/04.png',imgB:'../image/b04.png',caption:'贾探春',descF:'你的前世情人是她——贾探春。她精明能干，大观园中唯一具备政治风度的女性，同时探春的诗词和书法也在大观园中名列前茅，是贤才淑德的代表。',desc:'',key:4},
		  {img:'../image/05.png',imgB:'../image/b05.png',caption:'史湘云',descF:'你的前世情人是她——史湘云。她开朗豪爽，爱淘气，身为女子却有男儿的疏朗与开阔胸怀，笑容中散发着真挚无邪，和乐观的女人在一起生活，男人此生不会倦怠。',desc:'',key:5},
		  {img:'../image/06.png',imgB:'../image/b06.png',caption:'妙玉',descF:'你的前世情人是她——妙玉。她天赋聪慧，资质不凡。她茶艺精湛，与贾府四春的琴棋书画并称绝艺，得到了“气质美如兰，才华馥比仙”的美赞。',desc:'',key:6},
		  {img:'../image/07.png',imgB:'../image/b07.png',caption:'贾迎春',descF:'你的前世情人是她——贾迎春。她才貌双全，具有纯真、善良、宽厚、聪明等大家闺秀的风范，她的一生正是那个时代所孕育的温婉、柔顺女子命运的缩影 。',desc:'',key:7},
		  {img:'../image/08.png',imgB:'../image/b08.png',caption:'贾惜春',descF:'你的前世情人是她——贾惜春。她向往“大光明”，她耐得住寂寞，守得住凄凉，清净无为，圆融自通。她厌弃世俗的浮躁与丑陋，因其“洁”而不能忍受世间的污浊。',desc:'',key:8},
		  {img:'../image/09.png',imgB:'../image/b09.png',caption:'王熙凤',descF:'你的前世情人是她——王熙凤。她精明强干，没有绕着矛盾走，而是迎着矛盾上，在贾府中雷厉风行，在下人中十分具有威信。',desc:'',key:9},
		  {img:'../image/10.png',imgB:'../image/b10.png',caption:'巧姐',descF:'你的前世情人是她——贾巧姐。她是贾琏与王熙凤的女儿。因生在七月初七，刘姥姥给她取名为“巧姐”。生性天真烂漫，开朗活泼。',desc:'',key:10},
		  {img:'../image/11.png',imgB:'../image/b11.png',caption:'李纨',descF:'你的前世情人是她——李纨。她性格格外活泼，亦不乏幽默。她对自然美的审度能力之高令人赞叹。她入主大观园后，对园内事务却也十分热心，深得园内居民赞许和敬服。',desc:'',key:11},
		  {img:'../image/12.png',imgB:'../image/b12.png',caption:'秦可卿',descF:'你的前世情人是她——秦可卿。她长得袅娜纤巧，行事温柔和平，被贾母赞为重孙媳中第一个得意之人。',desc:'',key:12}

		];
		var LocString = String(window.document.location.href);
		var key = 1;
		function getQueryStr(str) { 
		var rs = new RegExp("(^|)" + str + "=([^&]*)(&|$)", "gi").exec(LocString), tmp; 
			if (tmp = rs) { 
				return tmp[2]; 
			} 
			// parameter cannot be found 
			return ""; 
		} 
		$(function(){
			
		});
		function rsort(n) {
			var _photo = $('.photo');
			var photos = [];
			for(var i=0; i<_photo.length; i++) {
				_photo[i].className = _photo[i].className.replace(/\s*photo_center\s*/,' ');
				_photo[i].className = _photo[i].className.replace(/\s*photo_back\s*/,' ');
				//_photo[i].className = _photo[i].className.replace(/\s*photo_front\s*/,' ');
				_photo[i].style = null;
				_photo[i].style['transform'] = 'rotate(360deg) scale(1.3)';
				_photo[i].style['-webkit-transform'] = 'rotate(360deg) scale(1.3)';
				_photo[i].style['-ms-transform'] = 'rotate(360deg) scale(1.3)';
				_photo[i].style['-o-transform'] = 'rotate(360deg) scale(1.3)';
				photos.push(_photo[i]);
			}

			var e = $('#photo_'+n)[0];
			e.className += ' photo_center';
			// 剔除正中
			photo_center = photos.splice(n-1,1)[0];

			// 拆分左右
			var photos_left = photos.splice(0,Math.ceil(_photo.length/2));
			var photos_right = photos;
			var ranges = range();

			for(var s in photos_left) {
				photos_left[s].style.left = random(ranges.left.x[0],ranges.left.x[1])+'px';
				photos_left[s].style.top = random(ranges.left.y[0],ranges.left.y[1])+'px';
				photos_left[s].style['transform'] = 'rotate('+random(-150,150)+'deg) scale(1)';
				photos_left[s].style['-webkit-transform'] = 'rotate('+random(-150,150)+'deg) scale(1)';
				photos_left[s].style['-ms-transform'] = 'rotate('+random(-150,150)+'deg) scale(1)';
				photos_left[s].style['-o-transform'] = 'rotate('+random(-150,150)+'deg) scale(1)';
			}

			for(var s in photos_right) {
				var photo = photos_right[s];
				photo.style.left = random(ranges.right.x[0],ranges.right.x[1])+'px';
				photo.style.top = random(ranges.right.y[0],ranges.right.y[1])+'px';
				photo.style['transform'] = 'rotate('+random(-150,150)+'deg) scale(1)';
				photo.style['-webkit-transform'] = 'rotate('+random(-150,150)+'deg) scale(1)';
				photo.style['-ms-transform'] = 'rotate('+random(-150,150)+'deg) scale(1)';
				photo.style['-o-transform'] = 'rotate('+random(-150,150)+'deg) scale(1)';
			}
		}
		
		// 计算左右分区范围
		function range() {
			var range = {left:{x:[],y:[]},right:{x:[],y:[]}};
			var wrap = {
				w:$(".wrap")[0].scrollWidth,
				h:$(".wrap")[0].scrollHeight
			};

			var photo = {
				w:$(".photo")[0].scrollWidth,
				h:$(".photo")[0].scrollHeight
			};

			//range.wrap = wrap;
			//range.photo = photo;

			range.left.x = [0-photo.w,wrap.w/2-photo.w/2];
			range.left.y = [0-photo.h,wrap.h];
			range.right.x = [wrap.w/2+photo.w/2,wrap.w+photo.w];
			range.right.y = range.left.y;

			return range;
		}

		// 取值范围
		function random(min, max) {
			var diff = max - min;
			return Math.ceil(Math.random()*diff);
		}

		function center(key) {
			var photo = $('.photo')[key];
			photo.className = photo.className+' photo_center';
		}

		function turn(i) {
			alert(i);
		}

	</script>
    <script type="text/jsx">
		/*	
			div.wrap
				div.photo[div.photo.photo_center]
					div.side.side-front
						p.img
						p.caption
					div.side.side-back
						o.desc
				div.nav
					span.i
		*/
		
		
		// 外层容器
		var PhotoC = React.createClass({
			componentDidMount: function() {
				//rsort(random(1,12));
				//alert(getQueryStr("key")-1+2);
				rsort(getQueryStr("key")-1+2);
				//center(random(1,12));
			},
			render: function() {
				/*var photoNodes = this.props.data.map(function (photo) {
					return (
						<Photo photo={photo} key={photo.key}/>
					);
				});*/

				var photoNodes = [];
				var photos = this.props.data;
				for(i in photos) {
					photoNodes.push(<Photo photo={photos[i]} key={photos[i].key}/>);
				}

				return (
					<div>
						<div className='wrap' id='wrap'>
							{photoNodes}
						</div>
					</div>
				)
			}
		});

		// 图片容器
		var Photo = React.createClass({
			clickTurn: function (e) {
				e.preventDefault();
				var pCls = this.getDOMNode().className;

				if(!/photo_center/.test(pCls)) {
					return rsort(this.props.photo.key);
				}

				if(/photo_front/.test( pCls )) {
					pCls = pCls.replace(/photo_front/,'photo_back');
				} else {
					pCls = pCls.replace(/photo_back/,'photo_front');
				}
				return e.currentTarget.className = pCls;
			},
			getInitialState: function() {
				return {
					photoClass: 'photo photo_front'
				}
			},
			render: function() {
				var photoClass = this.state.photoClass;
				var tempId = 'photo_'+this.props.photo.key;
				return (
					<div className={photoClass} onClick={this.clickTurn} id={tempId}>
						<div className='photo_wrap' >
							<div className='side side-front' >
								<p className='image'><img src={this.props.photo.img}/></p>
								<p className='caption'>{this.props.photo.descF}...<a href="">[点击了解更多]</a></p>
							</div>
							<div className='side side-back'>
								<p className='desc'>{this.props.photo.desc}</p>
								<p className='imageB'><img src={this.props.photo.imgB}/></p>
								<p className='desc'>{gg}</p>
							</div>
						</div>
					</div>
				)
			}
		});

		React.render(
		  <PhotoC data={data}/>,
		  document.getElementById('container')
		);

		function po(obj){
			var temp = ""; 
			for(var i in obj){//用javascript的for/in循环遍历对象的属性 
				temp += i+":"+obj[i]+"\n"; 
			} 
			alert(temp);
		}
		
    </script>
  </body>
</html>
