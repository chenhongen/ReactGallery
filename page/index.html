<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-type' content='text/html; charset=utf-8'>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=1.0, user-scalable=yes">
	<meta name="Description" content="素材来源网络，仅供学术交流">
    <title>前世</title>
    <script src="../js/react.min.js"></script>
    <script src="../js/JSXTransformer.js"></script>
    <script src="http://libs.baidu.com/jquery/1.11.1/jquery.min.js"></script>
	<!--<script src="../js/data.js"></script>-->
	<style>
		* {
			margin:0;
			padding:0;
		}
		a {
			text-decoration:none;
		}
		body{
			background-color:#fff;
			color:#555;
			font-family:'Avenir Next', 'Lantinghei SC';
			font-size:14px;
			-wevbkit-font-smoothing:antialiased;	
		}
		.wrap{
			width:100%;
			/*设置垂直居中start*/
			height:600px;
			position:absolute;
			top:50%;
			margin-top:-300px;
			/*设置垂直居中end*/
			background-color:#333;
			overflow:hidden;

			-webkit-perspective:800px;
			-moz-perspective:800px;
			perspective:800px;
		}
		.photo{
			width:260px;
			height:320px;
			position:absolute;
			z-index:1;
			box-shadow:0 0 1px rgba(0,0,0,.01);
			-webkit-transition:all .6s;
			transition:all .6s;
			-ms-transition:all .6s;
			-moz-transition:all .6s;
			-o-transition:all .6s;
			left:50%;
			top:50%;
			margin;-160px 0 0 -130px;
		}
		.photo .side{
			width:100%;
			height:100%;
			background-color:#eee;
			top:0;
			right:0;
			position:absolute;
			padding:20px;
			box-sizing:border-box;

		}
		.photo .side-front{}
		.photo .side-back .imageB{
			padding-top:10px;
			width:100%;
			height:200px;
			line-height:200px;
			overflow:hidden;
		}
		.photo .side-back .imageB img{
			
		}
		.photo .side-front .image{
			width:100%;
			height:250px;
			line-height:250px;
			overflow:hidden;
		}
		.photo .side-front .image img{
			width:100%;
		}
		.photo .side-front .caption{
			padding-top:10px;
			font-size:1em;
			text-indent: 2em;
			line-height:20px;
		}
		.photo .side-back{}
		.photo .side-back .desc{
			color:#666;
			font-size:14px;
			line-height:1.5em;
			text-indent: 2em;
		}
		/*选中：水平、垂直居中方法。设为宽高一半*/
		.photo_center {
			width:260px;
			height:320px;
			left:50%;
			top:50%;
			margin:-160px 0 0 -130px;
			z-index:999;
		}
		.photo_wrap{
			width:100%;
			height:118%;
			position:absolute;
			transform-style: preserve-3d;
			-webkit-transform-style: preserve-3d;	/* Safari 和 Chrome */
			-moz-transform-style: preserve-3d;

			-webkit-transition:-webkit-transform .6s ease-in-out;
			transition:transform .6s ease-in-out;
			-ms-transition:-ms-transform .6s ease-in-out;
			-moz-transition:-moz-transform .6s ease-in-out;
			-o-transition:-o-transform .6s ease-in-out;
			
			-webkit-transform-origin:0% 50%;
			transform-origin:0% 50%;
			-ms-transform-origin:0% 50%;
			-moz-transform-origin:0% 50%;
			-o-transform-origin:0% 50%;

		}
		.photo_wrap .side-front{
			transform:rotateY(360deg);
			-ms-transform:rotateY(360deg); 	/* IE 9 */
			-moz-transform:rotateY(360deg); 	/* Firefox */
			-webkit-transform:rotateY(360deg); /* Safari 和 Chrome */
			-o-transform:rotateY(360deg); 	/* Opera */

		}
		.photo_wrap .side-back{
			transform:rotateY(180deg);
			-ms-transform:rotateY(180deg); 	/* IE 9 */
			-moz-transform:rotateY(180deg); 	/* Firefox */
			-webkit-transform:rotateY(180deg); /* Safari 和 Chrome */
			-o-transform:rotateY(180deg); 	/* Opera */
		}
		.photo_wrap .side{
			backface-visibility:hidden;
			-webkit-backface-visibility:hidden;	/* Chrome 和 Safari */
			-moz-backface-visibility:hidden; 	/* Firefox */
			-ms-backface-visibility:hidden; 	/* Internet Explorer */
		}
		.photo_front .photo_wrap{
			transform:translate(0pc,0px) rotateY(0deg);
			-ms-transform:translate(0px,0px) rotateY(0deg); 	/* IE 9 */
			-moz-transform:translate(0px,0px) rotateY(0deg); 	/* Firefox */
			-webkit-transform:translate(0px,0px) rotateY(0deg); /* Safari 和 Chrome */
			-o-transform:translate(0px,0px) rotateY(0deg); 	/* Opera */
		}
		.photo_back .photo_wrap{
			transform:translate(260px,0px) rotateY(180deg);
			-ms-transform:translate(260px,0px) rotateY(180deg); 	/* IE 9 */
			-moz-transform:translate(260px,0px) rotateY(180deg); 	/* Firefox */
			-webkit-transform:translate(260px,0px) rotateY(180deg); /* Safari 和 Chrome */
			-o-transform:translate(260px,0px) rotateY(180deg); 	/* Opera */
		}
		@font-face{
			font-family:'Glyphicons Halflings';
			font-family:'Glyphicons Halflings';
			src:url('fonts/glyphicons-halflings-regular.eot');   /* IE9 Compat Modes */
			src:url('fonts/glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'),/* IE6-IE8 */
			url('fonts/glyphicons-halflings-regular.woff') format('woff'),  /* Modern Browsers */
			url('fonts/glyphicons-halflings-regular.ttf') format('truetype'),/* Safari, Android, iOS */
			url('fonts/glyphicons-halflings-regular.svg#glyphicons-halflingsregular') format('svg'); /* Legacy iOS */
			font-weight:normal;
			font-size:normal;
		}
	</style>
  </head>
  <body onselectstart="return false;">
    <div id="container">
    </div>
    <script >
		var data = [
		  {img:'../image/01.png',imgB:'../image/b01.png',caption:'林黛玉',descF:'  林如海与贾敏的女儿，因父母先后去世，外祖母怜其孤独，接来荣国府扶养。虽然她是寄人篱下的孤儿，但她',desc:'生性孤傲,天真率直,和宝玉同为封建的叛逆者，从不劝宝玉走封建的仕官道路，她蔑视功名权贵，和宝玉有着共同理想和志趣，真心相爱，但这一爱情被贾母等人残忍地扼杀了。',key:1},
		  {img:'../image/02.png',imgB:'../image/b02.png',caption:'薛宝钗 ',descF:'  家中拥有百万之富。容貌美丽，肌骨莹润，举止娴雅。她热衷于“仕途经济”，劝宝玉去会会做官的，谈讲谈讲',desc:'仕途经济，被宝玉背地里斥之为“混帐话”。她恪守封建妇德，而且城府颇深，贾宝玉被迫娶薛宝钗为妻。由于双方没有共同的理想与志趣，贾宝玉又无法忘怀知音林黛玉，婚后不久即出家当和尚去了。薛宝钗只好独守空闺，抱恨终身。',key:2},
		  {img:'../image/03.png',imgB:'../image/b03.png',caption:'贾元春',descF:'  贾政与王夫人之长女。自幼由贾母教养。作为长姐，她在宝玉三四岁时，就已教他读书识字，虽为姐弟，有如',desc:'母子。后因贤孝才德，选入宫作女吏。不久，封凤藻宫尚书，加封贤德妃。元妃虽给贾家带来了“烈火烹油，鲜花著锦之盛”，但她却被幽闭在皇家深宫内。这次省亲之后，元妃再无出宫的机会，后暴病而亡。',key:3},
		  {img:'../image/04.png',imgB:'../image/b04.png',caption:'贾探春',descF:'  贾政与妾赵姨娘所生，排行为贾府三小姐。她精明能干，有心机，能决断，连王夫人与凤姐都让她几分，有“玫瑰花”',desc:'之诨名，封建等级观念特别强烈。探春对贾府面临的大厦将倾的危局颇有感触，她想用“兴利除弊”的微小改革来挽救，但无济于事。最后贾探春远嫁他乡。',key:4},
		  {img:'../image/05.png',imgB:'../image/b05.png',caption:'史湘云',descF:'  贾母的侄孙女。豪门千金，由叔父史鼎抚养。她的身世与林黛玉有些相似，但她没有林黛玉的叛逆精神。她心直',desc:'口快，开朗豪爽，爱淘气，和宝玉也算是好朋友，时而亲热，时而恼火,但她襟怀坦荡，从未把儿女私情略萦心上。后嫁与卫若兰，婚后不久，丈夫即得暴病，后成痨症而亡，她立志守寡终身。',key:5},
		  {img:'../image/06.png',imgB:'../image/b06.png',caption:'妙玉',descF:'  苏州人氏。她祖上是读书仕宦人家。因自幼多病，买了许多替身，皆不中用。只得入了空门，身体才好,故一直',desc:'带发修行。父母已亡，身边带两个老嬷嬷，一个小丫头服侍。她极通文墨，极熟经典，模样又极好。后贾府败落,她被强人用迷魂香闷倒奸污，劫持而去。',key:6},
		  {img:'../image/07.png',imgB:'../image/b07.png',caption:'贾迎春',descF:'  贾迎春是贾赦与妾所生的，贾府二小姐。她老实无能，懦弱怕事，有“二木头”的诨名。她不但作诗猜谜',desc:'不如姐妹们，在处世为人上，也只知退让，任人欺侮。她父亲贾赦欠了孙家五千两银子还不出，就把她嫁给孙家，实际上是拿她抵债。出嫁后不久，她就被孙绍祖虐待而死。',key:7},
		  {img:'../image/08.png',imgB:'../image/b08.png',caption:'贾惜春',descF:'  贾珍的妹妹。因父亲贾敬一味好道炼丹，别的事一概不管，而母亲又早逝，她一直在荣国府贾母身边长大。',desc:'由于没有父母怜爱，养成了孤僻冷漠的性格，心冷嘴冷。抄检大观园时，对别人的流泪哀伤无动于衷。四大家族的没落命运，三个本家姐姐的不幸结局，使她产生了弃世的念头，后入栊翠庵为尼。',key:8},
		  {img:'../image/09.png',imgB:'../image/b09.png',caption:'王熙凤',descF:'  贾琏之妻，王夫人的内侄女。长著一双丹凤三角眼，两弯柳叶吊梢眉，身量苗条,体格风骚。她精明强干，深得',desc:'贾母和王夫人的信任并成为贾府的实际大管家。她极尽权术机变，残忍阴毒之能事，她极度贪婪，除了索取贿赂外，还靠著迟发公费月例放债。最后落得个“机关算尽太聪明，反算了卿卿性命”的下场。',key:9},
		  {img:'../image/10.png',imgB:'../image/b10.png',caption:'巧姐',descF:'  贾琏与王熙凤的女儿。因生在七月初七，刘姥姥给她取名为“巧姐”。巧姐从小生活优裕，是豪门千金。但在贾府',desc:'败落、王熙凤死后,舅舅王仁和贾环要把她卖与藩王作使女，在紧急关头，幸亏刘姥姥帮忙，把她乔装打扮带出大观园。后嫁给一个姓周的地主。',key:10},
		  {img:'../image/11.png',imgB:'../image/b11.png',caption:'李纨',descF:'  李纨，字宫裁，贾珠之妻，生有儿子贾兰。她出身金陵名宦，父亲李守中曾为国子祭酒。她从小就受父亲“女子无',desc:'才便是德”的教育，以认得几个字，记得前朝几个贤女便了，每日以纺织女红为要。贾珠不到二十岁就病死了。她是个恪守封建礼法的贤女节妇的典型。',key:11},
		  {img:'../image/12.png',imgB:'../image/b12.png',caption:'秦可卿',descF:'  贾蓉之妻。她是营缮司郎中秦邦业从养生堂抱养的女儿，小名可儿,大名兼美。她长得袅娜纤巧，性格风流，',desc:'行事又温柔和平，深得贾母等人的欢心。但公公贾珍与她关系暧昧，致使其年轻早夭。',key:12}

		];
		var LocString = String(window.document.location.href);
		var key = 1;
		function getQueryStr(str) { 
		var rs = new RegExp("(^|)" + str + "=([^&]*)(&|$)", "gi").exec(LocString), tmp; 
			if (tmp = rs) { 
				return tmp[2]; 
			} 
			// parameter cannot be found 
			return ""; 
		} 
		$(function(){
			
		});
		function rsort(n) {
			var _photo = $('.photo');
			var photos = [];
			for(var i=0; i<_photo.length; i++) {
				_photo[i].className = _photo[i].className.replace(/\s*photo_center\s*/,' ');
				_photo[i].className = _photo[i].className.replace(/\s*photo_back\s*/,' ');
				//_photo[i].className = _photo[i].className.replace(/\s*photo_front\s*/,' ');
				_photo[i].style = null;
				_photo[i].style['transform'] = 'rotate(360deg) scale(1.3)';
				_photo[i].style['-webkit-transform'] = 'rotate(360deg) scale(1.3)';
				_photo[i].style['-ms-transform'] = 'rotate(360deg) scale(1.3)';
				_photo[i].style['-o-transform'] = 'rotate(360deg) scale(1.3)';
				photos.push(_photo[i]);
			}

			var e = $('#photo_'+n)[0];
			e.className += ' photo_center';
			// 剔除正中
			photo_center = photos.splice(n-1,1)[0];

			// 拆分左右
			var photos_left = photos.splice(0,Math.ceil(_photo.length/2));
			var photos_right = photos;
			var ranges = range();

			for(var s in photos_left) {
				photos_left[s].style.left = random(ranges.left.x[0],ranges.left.x[1])+'px';
				photos_left[s].style.top = random(ranges.left.y[0],ranges.left.y[1])+'px';
				photos_left[s].style['transform'] = 'rotate('+random(-150,150)+'deg) scale(1)';
				photos_left[s].style['-webkit-transform'] = 'rotate('+random(-150,150)+'deg) scale(1)';
				photos_left[s].style['-ms-transform'] = 'rotate('+random(-150,150)+'deg) scale(1)';
				photos_left[s].style['-o-transform'] = 'rotate('+random(-150,150)+'deg) scale(1)';
			}

			for(var s in photos_right) {
				var photo = photos_right[s];
				photo.style.left = random(ranges.right.x[0],ranges.right.x[1])+'px';
				photo.style.top = random(ranges.right.y[0],ranges.right.y[1])+'px';
				photo.style['transform'] = 'rotate('+random(-150,150)+'deg) scale(1)';
				photo.style['-webkit-transform'] = 'rotate('+random(-150,150)+'deg) scale(1)';
				photo.style['-ms-transform'] = 'rotate('+random(-150,150)+'deg) scale(1)';
				photo.style['-o-transform'] = 'rotate('+random(-150,150)+'deg) scale(1)';
			}
		}
		
		// 计算左右分区范围
		function range() {
			var range = {left:{x:[],y:[]},right:{x:[],y:[]}};
			var wrap = {
				w:$(".wrap")[0].scrollWidth,
				h:$(".wrap")[0].scrollHeight
			};

			var photo = {
				w:$(".photo")[0].scrollWidth,
				h:$(".photo")[0].scrollHeight
			};

			//range.wrap = wrap;
			//range.photo = photo;

			range.left.x = [0-photo.w,wrap.w/2-photo.w/2];
			range.left.y = [0-photo.h,wrap.h];
			range.right.x = [wrap.w/2+photo.w/2,wrap.w+photo.w];
			range.right.y = range.left.y;

			return range;
		}

		// 取值范围
		function random(min, max) {
			var diff = max - min;
			return Math.ceil(Math.random()*diff);
		}

		function center(key) {
			var photo = $('.photo')[key];
			photo.className = photo.className+' photo_center';
		}

		function turn(i) {
			alert(i);
		}

	</script>
    <script type="text/jsx">
		/*	
			div.wrap
				div.photo[div.photo.photo_center]
					div.side.side-front
						p.img
						p.caption
					div.side.side-back
						o.desc
				div.nav
					span.i
		*/
		
		
		// 外层容器
		var PhotoC = React.createClass({
			componentDidMount: function() {
				//rsort(random(1,12));
				//alert(getQueryStr("key")-1+2);
				rsort(getQueryStr("key")-1+2);
				//center(random(1,12));
			},
			render: function() {
				/*var photoNodes = this.props.data.map(function (photo) {
					return (
						<Photo photo={photo} key={photo.key}/>
					);
				});*/

				var photoNodes = [];
				var photos = this.props.data;
				for(i in photos) {
					photoNodes.push(<Photo photo={photos[i]} key={photos[i].key}/>);
				}

				return (
					<div>
						<div className='wrap' id='wrap'>
							{photoNodes}
						</div>
					</div>
				)
			}
		});

		// 图片容器
		var Photo = React.createClass({
			clickTurn: function (e) {
				e.preventDefault();
				var pCls = this.getDOMNode().className;

				if(!/photo_center/.test(pCls)) {
					return rsort(this.props.photo.key);
				}

				if(/photo_front/.test( pCls )) {
					pCls = pCls.replace(/photo_front/,'photo_back');
				} else {
					pCls = pCls.replace(/photo_back/,'photo_front');
				}
				return e.currentTarget.className = pCls;
			},
			getInitialState: function() {
				return {
					photoClass: 'photo photo_front'
				}
			},
			render: function() {
				var photoClass = this.state.photoClass;
				var tempId = 'photo_'+this.props.photo.key;
				return (
					<div className={photoClass} onClick={this.clickTurn} id={tempId}>
						<div className='photo_wrap' >
							<div className='side side-front' >
								<p className='image'><img src={this.props.photo.img}/></p>
								<p className='caption'>{this.props.photo.descF}...<a href="">[点击查看详情]</a></p>
							</div>
							<div className='side side-back'>
								<p className='desc'>{this.props.photo.desc}</p>
								<p className='imageB'><img src={this.props.photo.imgB}/></p>
							</div>
						</div>
					</div>
				)
			}
		});

		React.render(
		  <PhotoC data={data}/>,
		  document.getElementById('container')
		);

		function po(obj){
			var temp = ""; 
			for(var i in obj){//用javascript的for/in循环遍历对象的属性 
				temp += i+":"+obj[i]+"\n"; 
			} 
			alert(temp);
		}
		
    </script>
  </body>
</html>
